!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("qs")):"function"==typeof define&&define.amd?define(["qs"],e):(t=t||self).route=e(t.qs)}(this,function(t){class e{constructor(t,e,r){if(this.name=t,this.ziggy=r,this.route=this.ziggy.namedRoutes[this.name],void 0===this.name)throw new Error("Ziggy Error: You must provide a route name");if(void 0===this.route)throw new Error("Ziggy Error: route '"+this.name+"' is not found in the route list");this.absolute=void 0===e||e,this.domain=this.setDomain(),this.path=this.route.uri.replace(/^\//,"")}setDomain(){if(!this.absolute)return"/";if(!this.route.domain)return this.ziggy.baseUrl.replace(/\/?$/,"/");let t=(this.route.domain||this.ziggy.baseDomain).replace(/\/+$/,"");return this.ziggy.basePort&&(t=t+":"+this.ziggy.basePort),this.ziggy.baseProtocol+"://"+t+"/"}construct(){return this.domain+this.path}}class r extends String{constructor(t,r,i,s=null){super(),this.name=t,this.absolute=i,this.ziggy=s||Ziggy,this.urlBuilder=this.name?new e(t,i,this.ziggy):null,this.template=this.urlBuilder?this.urlBuilder.construct():"",this.urlParams=this.normalizeParams(r),this.queryParams={},this.hydrated=""}normalizeParams(t){return void 0===t?{}:(t="object"!=typeof t?[t]:t,this.numericParamIndices=Array.isArray(t),Object.assign({},t))}with(t){return this.urlParams=this.normalizeParams(t),this}withQuery(t){return Object.assign(this.queryParams,t),this}hydrateUrl(){if(this.hydrated)return this.hydrated;let t=this.template.replace(/{([^}]+)}/gi,(t,e)=>{var r,i;let s,a,n=this.trimParam(t);if(this.ziggy.defaultParameters.hasOwnProperty(n)&&(s=this.ziggy.defaultParameters[n]),s&&!this.urlParams[n])return delete this.urlParams[n],s;this.numericParamIndices?(this.urlParams=Object.values(this.urlParams),a=this.urlParams.shift()):(a=this.urlParams[n],delete this.urlParams[n]);let u=null===(r=this.ziggy.namedRoutes[this.name])||void 0===r||null===(i=r.bindings)||void 0===i?void 0:i[n];if(u&&!this.urlParams[n]&&this.urlParams[u]?(a=this.urlParams[u],delete this.urlParams[u]):a||this.urlParams[n]||!this.urlParams.id||(a=this.urlParams.id,delete this.urlParams.id),null==a){if(-1===t.indexOf("?"))throw new Error("Ziggy Error: '"+n+"' key is required for route '"+this.name+"'");return""}return a.id?encodeURIComponent(a.id):a[u]?encodeURIComponent(a[u]):encodeURIComponent(a)});return null!=this.urlBuilder&&""!==this.urlBuilder.path&&(t=t.replace(/\/+$/,"")),this.hydrated=t,this.hydrated}matchUrl(){let t=window.location.hostname+(window.location.port?":"+window.location.port:"")+window.location.pathname,e=this.template.replace(/(\/\{[^\}]*\?\})/g,"/").replace(/(\{[^\}]*\})/gi,"[^/?]+").replace(/\/?$/,"").split("://")[1],r=this.template.replace(/(\{[^\}]*\})/gi,"[^/?]+").split("://")[1],i=t.replace(/\/?$/,"/");const s=new RegExp("^"+r+"/$").test(i),a=new RegExp("^"+e+"/$").test(i);return s||a}constructQuery(){if(0===Object.keys(this.queryParams).length&&0===Object.keys(this.urlParams).length)return"";let e=Object.assign(this.urlParams,this.queryParams);return t.stringify(e,{encodeValuesOnly:!0,skipNulls:!0,addQueryPrefix:!0,arrayFormat:"indices"})}current(t=null){let e=Object.keys(this.ziggy.namedRoutes).filter(t=>-1!==this.ziggy.namedRoutes[t].methods.indexOf("GET")&&new r(t,void 0,void 0,this.ziggy).matchUrl())[0];return t?new RegExp("^"+t.replace(".","\\.").replace("*",".*")+"$","i").test(e):e}check(t){return Object.keys(this.ziggy.namedRoutes).includes(t)}extractParams(t,e,r){const i=t.split(r);return e.split(r).reduce((t,e,r)=>0===e.indexOf("{")&&-1!==e.indexOf("}")&&i[r]?Object.assign(t,{[this.trimParam(e)]:i[r]}):t,{})}get params(){const t=this.ziggy.namedRoutes[this.current()];let e=window.location.pathname.replace(this.ziggy.baseUrl.split("://")[1].split("/")[1],"").replace(/^\/+/,"");return Object.assign(this.extractParams(window.location.hostname,t.domain||"","."),this.extractParams(e,t.uri,"/"))}parse(){this.return=this.hydrateUrl()+this.constructQuery()}url(){return this.parse(),this.return}toString(){return this.url()}trimParam(t){return t.replace(/{|}|\?/g,"")}valueOf(){return this.url()}}return function(t,e,i,s){return new r(t,e,i,s)}});
//# sourceMappingURL=route.js.map
